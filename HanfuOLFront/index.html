<!doctype html>
<html lang="zh">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <link rel="icon" href="dist/img/hualogo.gif" sizes="32x32" type="image/gif">
  <link rel="icon" href="dist/img/hualogo.gif" sizes="16x16" type="image/gif">
  <meta name="keywords" content="响应式后台模板,开源免费后台模板,bootstrap5后台管理系统模板">
  <meta name="description" content="bootstrap-admin基于bootstrap5的免费开源的响应式后台管理模板">
  <meta name="author" content="ajiho">
  <link rel="stylesheet" href="lib/bootstrap-icons/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="lib/overlayscrollbars/styles/overlayscrollbars.min.css">
  <link rel="stylesheet" href="dist/css/bootstrap-admin.min.css">
  <title>华裳在线汉服网络商城</title>
</head>

<body data-theme="light">
  <!-- 主页包括商品浏览，注册登录入口
购物车入口，管理订单页面和申请退货界面 -->
  <!--头部导航-->
  <ul class="bsa-header">
    <!-- 侧边栏触发按钮(移动端时显示) -->
    <li class="bsa-sidebar-toggler" data-bsa-toggle="pushmenu">
      <div class="bsa-header-item">
        <i class="bi bi-list"></i>
      </div>
    </li>
    <!--  搜索组件(不需要可删除)  -->
    <li>
      <div class="bsa-header-item bsa-cursor-default">
        <!--    搜索表单包裹区域        -->
        <div class="bsa-search-form-wrapper" data-bsa-toggle="navbar-search" data-close-reset="false"
          data-action="pages/search.html" data-params='{"type":"article","user":"admin2"}'>
          <div class="bsa-search-form">
            <input type="text" class="form-control bsa-input-search" aria-label="搜索关键词" placeholder="搜索关键词">
            <button class="bsa-search-submit-btn" type="submit"><i class="bi bi-search"></i></button>
            <button class="bsa-search-close-btn" type="button"><i class="bi bi-x-lg"></i></button>
          </div>
        </div>
        <!--    移动端搜索表单触发器(移动端会显示)        -->
        <i class="bi bi-search bsa-search-form-toggler bsa-cursor-pointer"></i>
      </div>
    </li>
    <!--  占位(可以让后面的li居右)  -->
    <li class="flex-grow-1"></li>
    <!--  通知(如果有新消息则添加类名.bsa-has-msg)  -->
    <li>
      <div class="bsa-header-item" data-qt-tab='{"title":"联系客服","url":"pages/message.html"}' data-qt-target=".qtab"
        style="font-size: smaller;">
        <i class="bi bi-bell bsa-has-msg"></i>联系客服
      </div>
    </li>
    <!--  拓展菜单(建议把拓展放在此处,以免破坏头部整体布局,不需要可以直接删除)  -->
    <li class="dropdown">
      <div class="bsa-header-item" data-bs-toggle="dropdown" data-bs-auto-close="outside" style="font-size: smaller;">
        <i class="bi bi-basket"></i>我的购物车
      </div>
      <div class="dropdown-menu dropdown-menu-end p-0">
        <div class="card shadow-sm">
          <div class="card-header d-flex justify-content-between bg-body">
            <span class="bsa-fs-15">我的购物车</span>
          </div>
          <div class="card-body">
            <div class="container-fluid">
              <div class="row row-cols-3 g-3">
                <a class="col text-decoration-none text-body-secondary d-flex flex-column align-items-center p-2 gap-1"
                  href="shoppingcart.html">
                  <div
                    class="d-flex align-items-center justify-content-center bsa-fs-25 bg-body-secondary  bsa-wh-45 rounded-circle">
                    <i class="bi bi-list"></i>
                  </div>
                  <div class="bsa-fs-14 bsa-ellipsis-2 text-center">购物车详情</div>
                </a>

                <a class="col text-decoration-none text-body-secondary d-flex flex-column align-items-center p-2 gap-1"
                  href="javascript:">
                  <div
                    class="d-flex align-items-center justify-content-center bsa-fs-25 bg-body-secondary bsa-wh-45 rounded-circle"
                    data-qt-tab='{"title":"订单详情","url":"pages/ordertable.html"}' data-qt-target=".qtab"
                    style="font-size: smaller;">
                    <i class="bi bi-list-check"></i>
                  </div>
                  <div class="bsa-fs-14 bsa-ellipsis-2 text-center"
                    data-qt-tab='{"title":"订单详情","url":"pages/ordertable.html"}'>订单详情</div>
                </a>

                <a class="col text-decoration-none text-body-secondary d-flex flex-column align-items-center p-2 gap-1"
                  href="javascript:">
                  <div
                    class="d-flex align-items-center justify-content-center bsa-fs-25 bg-body-secondary bsa-wh-45 rounded-circle"
                    data-qt-tab='{"title":"申请退货","url":"pages/refund.html"}' data-qt-target=".qtab"
                    style="font-size: smaller;">
                    <i class="bi bi-arrow-repeat"></i>
                  </div>
                  <div class="bsa-fs-14 bsa-ellipsis-2 text-center"
                    data-qt-tab='{"title":"申请退货","url":"pages/refund.html"}'>申请退货
                  </div>
                </a>
              </div>
            </div>
          </div>
          <div class="card-footer text-center bg-body">
            <a href="javascript:" class="bsa-fs-14 text-decoration-none text-body-secondary">随便逛逛</a>
          </div>
        </div>
      </div>
    </li>
    <!--  全屏  -->
    <li class="bsa-fullscreen-toggler">
      <div class="bsa-header-item" style="font-size: smaller;">
        <i class="bi bi-arrows-fullscreen"></i>全屏显示
      </div>
    </li>
    <!--  主题配色  -->
    <li class="dropdown">
      <div class="bsa-header-item" data-bs-toggle="dropdown" data-bs-auto-close="outside" style="font-size: smaller;">
        <i class="bi bi-palette"></i>主题配色
      </div>
      <div class="dropdown-menu dropdown-menu-end p-0">
        <div class="card shadow-sm">
          <div class="card-header d-flex justify-content-between bg-body">
            <span class="bsa-fs-15">主题配色</span>
          </div>
          <div class="card-body">
            <!--    配色包裹      -->
            <div class="bsa-theme-switcher-wrapper">
              <input class="form-check-input" type="checkbox" value="light">
              <input class="form-check-input" type="checkbox" value="dark">
              <input class="form-check-input" type="checkbox" value="indigo">
              <input class="form-check-input" type="checkbox" value="green">
              <input class="form-check-input" type="checkbox" value="blue">
              <input class="form-check-input" type="checkbox" value="yellow">
              <input class="form-check-input" type="checkbox" value="pink">
              <input class="form-check-input" type="checkbox" value="red">
              <input class="form-check-input" type="checkbox" value="orange">
              <input class="form-check-input" type="checkbox" value="cyan">
              <input class="form-check-input" type="checkbox" value="teal">
            </div>
          </div>
        </div>
      </div>
    </li>

    <!-- 未登录状态 -->
    <div id="login-dropdown" class="dropdown">
      <div class="bsa-header-item" data-bs-toggle="dropdown">
        <div class="bsa-user-area">
          <i class="bi bi-person-circle bsa-user-avatar"></i>

        </div>
      </div>
      <ul class="dropdown-menu dropdown-menu-end">
        <li>
          <a class="dropdown-item" href="login.html" target="_self">
            <i class="bi bi-box-arrow-in-right me-2"></i>登录
          </a>
        </li>
        <li>
          <a class="dropdown-item bsa-clear-cache" href="register.html" target="_self">
            <i class="bi bi-person-plus me-2"></i>注册
          </a>
        </li>
      </ul>
    </div>
    <!--    登录状态    -->
    <div id="profile-dropdown" class="dropdown">
      <div class="bsa-header-item" data-bs-toggle="dropdown">
        <div class="bsa-user-area">
          <img id="avatarImage" src="dist/img/avatar.jpg" class="bsa-user-avatar" alt="用户头像">
          <div class="bsa-user-details">
            <div class="bsa-ellipsis-1 bsa-fs-15" id="loginCustomer"></div>
            <!-- <span id="loginUser"></span>
          <div class="bsa-ellipsis-1 bsa-fs-15">欲饮琵琶马上催</div> -->

          </div>
        </div>
      </div>
      <ul class="dropdown-menu dropdown-menu-end">
        <li>
          <a class="dropdown-item" href="javascript:" data-qt-tab='{"title":"个人资料","url":"pages/profile.html"}'
            data-qt-target=".qtab">
            <i class="bi bi-person me-2"></i>个人资料
          </a>
        </li>
        <li>
          <a class="dropdown-item bsa-clear-cache" href="javascript:"
            data-qt-tab='{"title":"修改密码","url":"pages/password.html"}' data-qt-target=".qtab">
            <i class="bi bi-key me-2"></i>修改密码
          </a>
        </li>
        <li>
          <div class="dropdown-divider"></div>
        </li>
        <li class="bsa-logout"><a class="dropdown-item" id="btnLogout" href="javascript:"><i
              class="bi bi-box-arrow-right me-2"></i>退出登录</a>
        </li>
      </ul>
    </div>
  </ul>

  <!--侧边栏-->
  <div class="bsa-sidebar">
    <div class="card border-0 h-100">
      <!--  侧边栏头部(用于展示品牌logo)  -->
      <div class="card-header bg-body d-flex align-items-center flex-shrink-0">
        <img src="dist/img/hualogo.gif" class="bsa-logo-icon" alt="logo-icon" width="32" height="32">
        <div class="bsa-logo-text ms-2 bsa-ellipsis-2">华裳在线汉服网络商城</div>
      </div>
      <!--  侧边栏身体部分(用于主要的侧边栏菜单)  -->
      <div class="card-body p-0" data-overlayscrollbars-initialize>
        <!--   侧边栏的菜单     -->
        <ul class="bsa-menu" data-bsa-toggle="sidebar" data-accordion="true" data-click-close="true">
          <li>
            <a href="pages/welcome.html">
              <i class="bi bi-house"></i>首页
            </a>
          </li>
          <li>
            <a href="javascript:" class="has-children">
              <i class="bi bi-person-lock"></i>商家推荐
            </a>
            <ul>
              <li>
                <a href="pages/product.html">精品汉服</a>
              </li>
              <li>
                <a href="pages/user2.html">精品汉服2</a>
              </li>
              <li>
                <a href="pages/role.html">精品汉服3</a>
              </li>
              <li>
                <a href="pages/node.html">精品汉服4</a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <!--  侧边栏底部(用于演示,不需要可删除)  -->
      <div class="card-footer bg-body">
        小阳制作
      </div>
    </div>
  </div>

  <!--内容区域(.bsa-content-fixed类删除后即可变成单页版本)-->
  <div class="bsa-content bsa-content-fixed">
    <div class="qtab" data-qt-tabs='[{"title":"首页","url":"pages/welcome.html","close":false}]'></div>
  </div>

  <!--版权信息-->
  <div class="bsa-footer">
    <p class="mb-0">Copyright © 2023 华裳网络. All right reserved.</p>
  </div>

  <!--加载层-->
  <div class="bsa-preloader">
    <div class="spinner-border text-secondary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>


  <script src="lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/jquery/dist/jquery.min.js"></script>
  <script src="lib/overlayscrollbars/browser/overlayscrollbars.browser.es6.min.js"></script>
  <script src="lib/bootstrap-quicktab/dist/js/bootstrap-quicktab.min.js"></script>
  <script src="dist/js/bootstrap-admin.min.js"></script>
  <script src="dist/js/app.js"></script>
  <script type="text/javascript" src="pagejs/rockjs-1.0.js"></script>
  <script type="text/javascript" src="pagejs/common.js"></script>

  <!--假数据模拟,生产环境中请直接删除该js-->
  <!-- <script src="dist/js/bootstrap-admin.mock.js"></script> -->

  <script>
    var ssoUser = null;  //当前用户
    /**
   * 装载用户信息
   */
    function loadUser() {
      _root.loginCustomer({}, function (rtn, status) {
        if (rtn.hasError) {
          alert(rock.errorText(rtn, "获得当前用户失败！"));
        } else {
          ssoUser = rtn.result;
          console.log(rtn);//破局之法应该是在空对象中传入当前用户的id
          console.log(rtn.result);//破局之法应该是在空对象中传入当前用户的id
        }
        //根据登录状态修改个人信息
        if (rock.isNull(ssoUser)) {
          $("#loginCustomer").html("未知用户");
        } else {
          $("#loginCustomer").html(ssoUser.name);
        }
        if (rtn.notNull) {
          document.getElementById("login-dropdown").style.display = "none";
          document.getElementById("profile-dropdown").style.display = "block";
          //登录后修改头像
          var mvc = rock.initSvr(["customer"]);
          var customerService = mvc.findService("customer");
          if (ssoUser.hasPhoto) {
            $("#avatarImage").attr("src", customerService.url("photo") + "?id=" + ssoUser.id);

          }
        } else {
          document.getElementById("login-dropdown").style.display = "block";
          document.getElementById("profile-dropdown").style.display = "none";
        }

        console.log(ssoUser + "sssssssssssssssssssss");
      })
    }
    $(document).ready(function () {
      // var {
      //   OverlayScrollbars,
      //   ScrollbarsHidingPlugin,
      //   SizeObserverPlugin,
      //   ClickScrollPlugin
      // } = OverlayScrollbarsGlobal;
      // const osInstance = OverlayScrollbars(document.querySelector('body'), {});

      loadUser();
      //头部搜索框处理(不需要可以删除,不明白的可以看bootstrap-admin官方文档)
      $(document).on('search.bsa.navbar-search', function (e, inputValue, data) {
        //先得到请求地址,组合后大概是这样pages/search.html?keyword=dsadsa&type=article&user=admin2
        let url = data.action + '?keyword=' + inputValue + '&' + $.param(data.params);

        //然后通过tab打开一个搜索结果的窗口
        Quicktab.get('.qtab').addTab({
          title: '<i class="bi bi-search"></i><span class="text-danger ms-2">' + inputValue + '</span>',
          url: url,
          close: true,
        })
      })

      //退出登录
      $(document).on('click', '.bsa-logout', function (e) {
        e.preventDefault();
        $.modal({
          body: '确定要退出吗？',
          cancelBtn: true,
          ok: function (evt) {
            _root.logout({}, (rtn) => {
              if (rtn.hasError || !rtn.result) {
                alert("注销登录出错!");
              } else {
                location.href = "index.html";
              }
            });

          }
        })


      });
    });



  </script>
</body>

</html>